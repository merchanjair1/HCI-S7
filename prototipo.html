<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <script src="https://cdn.tailwindcss.com"></script>
  <title>Add Product Advanced</title>
  <link href="https://cdn.jsdelivr.net/npm/flowbite@4.0.1/dist/flowbite.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/flowbite@4.0.1/dist/flowbite.min.js"></script>
</head>

<section class="bg-white dark:bg-gray-900">
    <div class="py-8 px-4 mx-auto max-w-2xl lg:py-16">
  
        <h2 class="mb-4 text-xl font-bold text-gray-900 dark:text-white">Add a new product</h2>
  
        <!-- ðŸ¦´ Skeleton Loader -->
        <div id="skeleton" class="space-y-4">
          <div class="h-6 bg-gray-300 rounded animate-pulse"></div>
          <div class="h-6 bg-gray-300 rounded animate-pulse"></div>
          <div class="h-6 bg-gray-300 rounded animate-pulse"></div>
          <div class="h-6 bg-gray-300 rounded animate-pulse w-1/2"></div>
        </div>
  
        <!-- ðŸ“ Formulario real -->
        <form id="productForm" class="hidden">
  
            <div class="grid gap-4 sm:grid-cols-2 sm:gap-6">
                <div class="sm:col-span-2">
                    <label for="name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Product Name</label>
                    <input type="text" name="name" id="name"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg block w-full p-2.5"
                        placeholder="Type product name" required="">
                </div>
  
                <div class="w-full">
                    <label for="brand" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Brand</label>
                    <input type="text" name="brand" id="brand"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg block w-full p-2.5"
                        placeholder="Product brand" required="">
                </div>
  
                <div class="w-full">
                    <label for="price" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Price</label>
                    <input type="number" name="price" id="price"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg block w-full p-2.5"
                        placeholder="$2999" required="">
                </div>
  
                <div>
                    <label for="category" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Category</label>
                    <select id="category"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg block w-full p-2.5">
                        <option selected="">Select category</option>
                        <option value="TV">TV/Monitors</option>
                        <option value="PC">PC</option>
                        <option value="GA">Gaming/Console</option>
                        <option value="PH">Phones</option>
                    </select>
                </div>
  
                <div>
                    <label for="item-weight" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Item Weight (kg)</label>
                    <input type="number" name="item-weight" id="item-weight"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg block w-full p-2.5"
                        placeholder="12" required="">
                </div>
  
                <div class="sm:col-span-2">
                    <label for="description" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Description</label>
                    <textarea id="description" rows="8"
                        class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300"
                        placeholder="Your description here"></textarea>
                </div>
            </div>
  
            <button type="submit"
                class="inline-flex items-center px-5 py-2.5 mt-4 sm:mt-6 text-sm font-medium text-white bg-blue-700 rounded-lg hover:bg-blue-800">
                Add product
            </button>
        </form>
  
        <!-- ðŸŒµ Empty State -->
        <div id="emptyState" class="hidden text-center py-8">
          <div class="text-6xl">ðŸ“¦</div>
          <p class="text-gray-700 mt-3">AÃºn no hay productos agregados.</p>
          <p class="text-blue-600 font-semibold">Â¡Agrega tu primer producto!</p>
        </div>
  
        <!-- ðŸ“‹ Lista de productos -->
        <div id="productList" class="mt-6 space-y-3"></div>
  
        <!-- âŒ Error -->
        <div id="errorBox" class="hidden mt-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded">
          <p id="errorMsg"></p>
          <button id="retryBtn" class="mt-2 bg-red-600 text-white px-4 py-2 rounded">Reintentar</button>
        </div>
  
    </div>
  </section>
  
  <!-- ========================= -->
  <!--       JAVASCRIPT         -->
  <!-- ========================= -->
  <script>
  /* -------------------------------
     ðŸ¦´ 1. Skeleton Loader
  ---------------------------------*/
  setTimeout(() => {
    document.getElementById("skeleton").classList.add("hidden");
    document.getElementById("productForm").classList.remove("hidden");
    document.getElementById("emptyState").classList.remove("hidden");
  }, 2000);
  
  
  /* --------------------------------------
     â­ 2. Optimistic UI + Manejo de error
  -----------------------------------------*/
  const form = document.getElementById("productForm");
  const productList = document.getElementById("productList");
  const emptyState = document.getElementById("emptyState");
  const errorBox = document.getElementById("errorBox");
  const errorMsg = document.getElementById("errorMsg");
  
  form.addEventListener("submit", (e) => {
    e.preventDefault();
  
    const product = {
      name: name.value,
      brand: brand.value,
      price: price.value,
    };
  
    // optimistic update
    const tempId = Date.now();
    const tempItem = document.createElement("div");
    tempItem.className = "p-4 rounded border bg-gray-50 animate-pulse";
    tempItem.id = tempId;
    tempItem.textContent = "Guardando producto...";
    productList.appendChild(tempItem);
  
    emptyState.classList.add("hidden");
  
    // simulate server
    setTimeout(() => {
      const success = Math.random() > 0.5;
  
      if (success) {
        tempItem.classList.remove("animate-pulse");
        tempItem.classList.add("bg-white");
        tempItem.textContent =
          `${product.name} - ${product.brand} ($${product.price})`;
      } else {
        tempItem.remove();
        errorMsg.textContent = "No se pudo guardar el producto. Intenta de nuevo.";
        errorBox.classList.remove("hidden");
      }
    }, 2000);
  });
  
  /* --------------------------------------
     ðŸ” Retry
  -----------------------------------------*/
  document.getElementById("retryBtn").addEventListener("click", () => {
    errorBox.classList.add("hidden");
  });
  </script>
  
</html>
